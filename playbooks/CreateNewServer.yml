---
- hosts: Satellite
  become: true

  tasks: 

      - name: Clone/Update repository to destination
        git:
            repo: 'https://github.com/mordan34/weizmann.git'
            dest: /opt/weizmann
            clone: yes
            update: yes
            force: yes

      - name: Execute Hammer script to create server {{ hostname }}
        command: "cd /root/weizmann/playbooks; /usr/bin/ansible-playbook addnewrecord.yml -e hostname={{ hostname }}"
        delegate_to: localhost
      
      - name: Execute Hammer script to create server {{ hostname }}
        command: /bin/bash -c "/opt/weizmann/scripts/createhost.sh {{ hostname }} "
