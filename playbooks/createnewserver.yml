---
- hosts: satellite
  become: true
  remote_user: ansible
  vars_files:
    - inventory/group_vars/nios.yml
    - inventory/group_vars/vault

  tasks: 

      - name: Clone/Update repository to destination
        git:
            repo: 'https://github.com/mordan34/weizmann.git'
            dest: /opt/weizmann
            clone: yes
            update: yes
            force: yes
      
      - name: Execute Hammer script to create server {{ hostname }}
        command: /bin/bash -c "/opt/weizmann/scripts/createhost.sh {{ hostname }} "

      - name: Execute Hammer script to create server {{ hostname }}
        command: /bin/bash -c "/opt/weizmann/scripts/openrules.py {{ hostname }} "
